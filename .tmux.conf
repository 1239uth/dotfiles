# Base configs taken from: https://gist.github.com/tsl0922/d79fc1f8097dde660b34
# vim style tmux config

# Change prefix from C-a
unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

# Start windows and panes at 1, not 0
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on

# Easy config reload
bind-key r source-file ~/.tmux.conf \; display-message "tmux.conf reloaded."

# vi is good
setw -g mode-keys vi

# mouse behavior
setw -g mouse on

bind-key : command-prompt
# bind-key r refresh-client
bind-key L clear-history

# bind-key space next-window
# bind-key bspace previous-window
# bind-key enter next-layout

# use vim-like keys for splits and windows
bind-key v split-window -h -c '#{pane_current_path}' # use current path for new split
bind-key s split-window -v -c '#{pane_current_path}'
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

# Use Options + Shift + H or L to switch windows, similar to using H and L to switch tabs in neovim
bind -n Ó next-window
bind -n Ò previous-window

bind-key C-o rotate-window

bind-key + select-layout main-horizontal
bind-key = select-layout main-vertical

set-window-option -g other-pane-height 25
set-window-option -g other-pane-width 80
set-window-option -g display-panes-time 1500
set-window-option -g window-status-current-style fg=magenta

bind-key a last-pane
bind-key q display-panes
bind-key c new-window
# bind-key t next-window
# bind-key T previous-window

bind-key [ copy-mode
bind-key ] paste-buffer

# Setup 'v' to begin selection as in Vim
bind-key -T copy-mode-vi v send -X begin-selection
bind-key -T copy-mode-vi y send -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"

# Update default binding of `Enter` to also use copy-pipe
unbind -T copy-mode-vi Enter
bind-key -T copy-mode-vi Enter send -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"

# # Status Bar
# set -g status-left-length 85
# set -g status-left "session:#[fg=colour135] #S"
# # set -g window-status-current-format "#[fg=black,bold bg=default]│#[fg=colour135 bg=black]#W#[fg=black,bold bg=default]│"
# set -g window-status-current-format "#[fg=colour255,bg=colour31,bold]#I:#W"
# set -g status-style bg=default
# # set -g status-right "#[fg=magenta] #[bg=default] %b %d %Y %l:%M %p"
# set -g status-right ""
# set -g status-justify centre

# set-option -g status-interval 1
# set-option -g status-style bg=black
# set-option -g status-style fg=white
# set -g status-left '#[fg=green]#H #[default]'
# set -g status-right '%a %p#[default]'

# set-option -g pane-active-border-style fg=yellow
# set-option -g pane-border-style fg=cyan

# Set window notifications
setw -g monitor-activity on
set -g visual-activity on

# Enable native Mac OS X copy/paste
set-option -g default-command "/bin/bash -c 'which reattach-to-user-namespace >/dev/null && exec reattach-to-user-namespace $SHELL -l || exec $SHELL -l'"

# Allow the arrow key to be used immediately after changing windows
set-option -g repeat-time 0

bind-key x kill-pane # close current pane without confirmation

# Fix neovim colors, from: https://gist.github.com/andersevenrud/015e61af2fd264371032763d4ed965b6
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

# Fix neovim escape delay
set -s escape-time 0

# tpm plugin
set -g @plugin 'tmux-plugins/tpm'

# list of tmux plugins
# set -g @plugin 'christoomey/vim-tmux-navigator' # for navigating panes and vim/nvim with Ctrl-hjkl

# set -g @plugin 'jimeh/tmux-themepack' # to configure tmux theme
# set -g @themepack 'powerline/default/cyan' # use this theme for tmux

set -g @plugin 'tmux-plugins/tmux-resurrect' # persist tmux sessions after computer restart
set -g @plugin 'tmux-plugins/tmux-continuum' # automatically saves sessions for you every 15 minutes


set -g @resurrect-capture-pane-contents 'on' # allow tmux-ressurect to capture pane contents
set -g @continuum-restore 'on' # enable tmux-continuum functionality

set -g @catppuccin_flavour 'mocha'
set -g @plugin 'catppuccin/tmux'

# Improve window path by applying the shell script ~/tmux/scripts/shorten_path.sh
set -g @catppuccin_window_current_text "#(echo '#{pane_current_path}' | scripts/shorten_path.sh)"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
